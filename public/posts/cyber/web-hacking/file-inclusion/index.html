<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>My New Hugo Site</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="LFI
L&rsquo;inclusion de fichiers locaux (LFI) est une vulnérabilité de sécurité qui se produit lorsqu&rsquo;une appli web permet aux utilisateurs d&rsquo;inclure des fichiers du système de fichiers local.
Les attaquants exploitent LFI en manipulant les champs de saisie pour récupérer des fichiers sensibles ou exécuter du code malveillant (RCE).
Fonction PHP vulnérable:
require, require_once, include, include_once.
Outils:
https://github.com/kurobeats/fimap
fimap, outil en python pour trouver les bogues de fichiers locaux et distants dans les applications.">
    <meta name="generator" content="Hugo 0.139.2">
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/posts/cyber/web-hacking/file-inclusion/">
    

    <meta property="og:url" content="http://localhost:1313/posts/cyber/web-hacking/file-inclusion/">
  <meta property="og:site_name" content="My New Hugo Site">
  <meta property="og:title" content="My New Hugo Site">
  <meta property="og:description" content="LFI L’inclusion de fichiers locaux (LFI) est une vulnérabilité de sécurité qui se produit lorsqu’une appli web permet aux utilisateurs d’inclure des fichiers du système de fichiers local.
Les attaquants exploitent LFI en manipulant les champs de saisie pour récupérer des fichiers sensibles ou exécuter du code malveillant (RCE).
Fonction PHP vulnérable: require, require_once, include, include_once.
Outils: https://github.com/kurobeats/fimap fimap, outil en python pour trouver les bogues de fichiers locaux et distants dans les applications.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">

  <meta itemprop="name" content="My New Hugo Site">
  <meta itemprop="description" content="LFI L’inclusion de fichiers locaux (LFI) est une vulnérabilité de sécurité qui se produit lorsqu’une appli web permet aux utilisateurs d’inclure des fichiers du système de fichiers local.
Les attaquants exploitent LFI en manipulant les champs de saisie pour récupérer des fichiers sensibles ou exécuter du code malveillant (RCE).
Fonction PHP vulnérable: require, require_once, include, include_once.
Outils: https://github.com/kurobeats/fimap fimap, outil en python pour trouver les bogues de fichiers locaux et distants dans les applications.">
  <meta itemprop="wordCount" content="383">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="My New Hugo Site">
  <meta name="twitter:description" content="LFI L’inclusion de fichiers locaux (LFI) est une vulnérabilité de sécurité qui se produit lorsqu’une appli web permet aux utilisateurs d’inclure des fichiers du système de fichiers local.
Les attaquants exploitent LFI en manipulant les champs de saisie pour récupérer des fichiers sensibles ou exécuter du code malveillant (RCE).
Fonction PHP vulnérable: require, require_once, include, include_once.
Outils: https://github.com/kurobeats/fimap fimap, outil en python pour trouver les bogues de fichiers locaux et distants dans les applications.">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        My New Hugo Site
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1"></h1>
      
      
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><h2 id="lfi">LFI</h2>
<p>L&rsquo;inclusion de fichiers locaux (LFI) est une vulnérabilité de sécurité qui se produit lorsqu&rsquo;une appli web permet aux utilisateurs d&rsquo;inclure des fichiers du système de fichiers local.</p>
<p>Les attaquants exploitent LFI en manipulant les champs de saisie pour récupérer des fichiers sensibles ou exécuter du code malveillant (RCE).</p>
<p>Fonction PHP vulnérable:
require, require_once, include, include_once.</p>
<p>Outils:
<a href="https://github.com/kurobeats/fimap">https://github.com/kurobeats/fimap</a>
fimap, outil en python pour trouver les bogues de fichiers locaux et distants dans les applications.</p>
<h3 id="exemple">Exemple:</h3>
<p>![[Pasted image 20240926183000.png]]</p>
<p>Tout d&rsquo;abord, l&rsquo;utilisateur envoie une requête HTTP au serveur web qui inclut un fichier à afficher.
Dans notre cas, pouvoir accéder à son cv, dans la requête peut prendre en paramètre le &lsquo;userCV.pdf&rsquo;, donc le fichier auquel l&rsquo;utilisateur veut accéder.</p>
<h3 id="octet-nul-00">Octet nul (%00)</h3>
<p>Contourner l&rsquo;ajout de caractères supplémentaires à la fin de chaîne fournie
Exemple:
&ldquo;<a href="http://example.com/index.php?page=../../../etc/passwd%00%22">http://example.com/index.php?page=../../../etc/passwd%00&quot;</a>
(ceci est résolu depuis PHP 5.4)</p>
<h3 id="technique-de-troncature-de-chemin">Technique de troncature de chemin</h3>
<p>La troncature de chemin est une méthode utilisée pour manipuler les chemins d&rsquo;accès aux fichiers dans les applications web.
Elle est souvent utilisée pour accéder à des fichiers restreints en contournant certaines mesures de sécurité qui ajoutent des caractères supplémentaires à la fin des chemins d&rsquo;accès aux fichiers.
L&rsquo;objectif est de créer un chemin d&rsquo;accès au fichier qui, une fois modifié par la mesure de sécurité, pointe toujours vers le fichier souhaité.</p>
<h4 id="exemple-en-php">Exemple en PHP:</h4>
<p>/etc/passwd, /etc/passwd, /etc/./passwd, et /etc/passwd/  sont tous traités comme le même chemin.</p>
<p>d&rsquo;autre tips sur <a href="https://book.hacktricks.xyz/pentesting-web/file-inclusion">https://book.hacktricks.xyz/pentesting-web/file-inclusion</a></p>
<h3 id="a-partir-dun-dossier-existant">A partir d&rsquo;un dossier existant</h3>
<p>Peut-être que le back-end vérifie le chemin du dossier:
&ldquo;<a href="http://example.com/index.php?page=utils/scripts/../../../../../etc/passwd%22;">http://example.com/index.php?page=utils/scripts/../../../../../etc/passwd&quot;;</a></p>
<h2 id="rfi">RFI</h2>
<p>L&rsquo;inclusion de fichier a distance est une technique permettant d&rsquo;inclure des fichiers distants dans une application vulnérable.
RFI se produit lors d&rsquo;une désinfection incorrecte de la saisie de l&rsquo;utlisateur
Condition requise: l&rsquo;option &ldquo;allow_url_fopen&rdquo; doit être activé
=&gt; allow_url_fopen est une option de configuration de php qui permet d&rsquo;ouvir des fichiers distants via des urls.</p>
<p>Les conséquences d&rsquo;une attaques RFI sont:</p>
<ul>
<li>Divulgation d&rsquo;informations sensibles</li>
<li>script instersite soit XSS</li>
<li>déni de service DoS</li>
</ul>
<h3 id="exemple-1">Exemple:</h3>
<p>Pour qu&rsquo;une attaque RFI puisse fonctionner, il faut qu&rsquo;un serveur externe puisse communiquer avec le serveur d&rsquo;applications. L&rsquo;attaquant héberge alors des fichiers malveillants sur son serveur. Le fichier malveillants est ensuite injecté dans la fonction include via des requêtes HTTP et le contenu du fichier malveillant s&rsquo;exécute sur le serveur d&rsquo;applications vulnérable.
![[Pasted image 20240926184023.png]]
python -m http.server 8000</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  My New Hugo Site 2024 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
